# Enable Helm OOM watch feature
- target:
    kind: Deployment
    name: helm-controller
  patch: |
    - op: add
      path: /spec/template/spec/containers/0/args/-
      value: --feature-gates=OOMWatch=true
    # Threshold at which to trigger a graceful shutdown (optional, default 95%)
    - op: add
      path: /spec/template/spec/containers/0/args/-
      value: --oom-watch-memory-threshold=95
    # Interval at which to check memory usage (optional, default 500ms)
    - op: add
      path: /spec/template/spec/containers/0/args/-
      value: --oom-watch-interval=500ms
